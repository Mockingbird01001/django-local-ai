import{s as b,a as k,F as w}from"./FormCard-03e23457.js";import{d as f,r as m,j as L,f as l,k as h,w as x,a as s,b as c,u as p,c as d,g as _,n as V,p as i,q as u,v as C}from"./index-90d3d32d.js";const $=s("div",{class:"hidden text-3xl text-center lg:block"},"Login",-1),y={class:"lg:pt-8"},B={class:"p-float-label"},H=s("label",{for:"username"},"Username",-1),M=["innerHTML"],T={class:"mt-5"},U={class:"p-float-label"},F=s("label",{for:"password"},"Password",-1),N=["innerHTML"],j={class:"pt-5 text-center"},q=f({__name:"LoginForm",setup(g){const a=m(),t=m(),r=L({errors:{}});async function v(){const{error:n,res:e,errors:o}=await V.post("/api/account/login",{username:a.value,password:t.value});n?n.type=="validation"?(console.log("422",o),r.errors=o,"__all__"in r.errors&&u.warn("Login error",r.errors.__all__,6e4)):e.status==401&&u.warn("Login error",e.data.message,6e4):(console.log("Login ok"),i.name.value=a.value,i.isLoggedIn.value=!0,u.success("Ok",`User ${i.name.value} is logged in`),C.push("/"))}return(n,e)=>(l(),h(w,{class:"mx-3"},{default:x(()=>[$,s("div",y,[s("span",B,[c(p(b),{id:"username",type:"text",modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=o=>a.value=o)},null,8,["modelValue"]),H]),"username"in r.errors?(l(),d("small",{key:0,id:"username-help",class:"p-error",innerHTML:r.errors.username},null,8,M)):_("",!0)]),s("div",T,[s("span",U,[c(p(k),{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value=o),feedback:!1},null,8,["modelValue"]),F]),"password"in r.errors?(l(),d("small",{key:0,id:"password-help",class:"p-error",innerHTML:r.errors.password},null,8,N)):_("",!0)]),s("div",j,[s("button",{class:"w-full btn bord-background success",onClick:e[2]||(e[2]=o=>v())},"Login"),s("button",{class:"mt-5 btn txt-light",onClick:e[3]||(e[3]=o=>n.$router.back())},"Cancel")])]),_:1}))}}),E={class:"mt-5 lg:mt-12"},P=f({__name:"LoginView",setup(g){return(a,t)=>(l(),d("div",E,[c(q,{class:"app-form"})]))}});export{P as default};
